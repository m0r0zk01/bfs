{% extends 'patterns/base.html' %}

{% block content %}

    {% include 'patterns/sidebar.html' %}

    <div class="container d-flex mx-auto mt-2" style="flex-direction: column">
        <form class="row">
            <div class="form-group col-5">
                <input type="file" name="upload_image" id="upload_image">
            </div>
            <div class="col-7">
                <button type="button" id="upload_image_btn" class="btn btn-primary">Добавить изображение</button>
            </div>
        </form>
        <form class="row">
            <div class="form-group col-5">
                <input type="text" class="form-control" name="text" placeholder="Текст..." id="text" required>
            </div>
            <div class="col-7">
                <button type="button" id="add_text_btn" class="btn btn-primary">Добавить текст</button>
            </div>
        </form>
        <canvas id="editor" class="mt-3" style="max-width: 800px; height: auto"></canvas>
    </div>
    <>
{% endblock %}

{% block scripts %}
    <script>
        $(document).ready(() => {
            init();
            $('#upload_image_btn').on('click', () => {
                let file = $('#upload_image').prop('files')[0];
                let reader = new FileReader();
                reader.onload = function (e) {
                    let img = new Image();
                    img.src = e.target.result;
                    img.onload = function (i) {
                        addImage(i.target);
                        draw();
                    };
                };
                reader.readAsDataURL(file);
            });

            $('#add_text_btn').on('click', () => {
                let input = $('#text');
                let obj = {
                    text: input.val(),
                    color: '#000000',
                    font: 'Arial',
                    size: '30pt',
                    bold: false,
                    cursive: false,
                    underline: false,
                };
                input.val('');
                addText(obj);
                draw();
            });
            
        });

    </script>
{% endblock %}