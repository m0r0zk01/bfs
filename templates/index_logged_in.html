{% extends 'patterns/base.html' %}

{% block content %}

    {% include 'patterns/sidebar.html' %}

    <div class="container d-flex mx-auto mt-2" style="flex-direction: column">
        <form class="form-inline">
            <div class="form-group">
                <label for="upload_image">Добавить изображение на холст</label>
                <input type="file" name="upload_image" id="upload_image">
            </div>
            <button type="button" id="upload_image_btn" class="btn btn-primary">Добавить</button>
        </form>
        <canvas id="editor" class="mt-3" style="max-width: 800px; height: auto"></canvas>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        $(document).ready(() => {
            init();
            $('#upload_image_btn').on('click', () => {
                console.log('loading');
                let file = $('#upload_image').prop('files')[0];
                let reader = new FileReader();
                reader.onload = function (e) {
                    let img = new Image();
                    img.src = e.target.result;
                    img.onload = function (i) {
                        addObject(i.target);
                        draw();
                    };
                };
                reader.readAsDataURL(file);
            });
        });

    </script>
{% endblock %}